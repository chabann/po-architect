# ADR 008: Выбор инструментов для CI/CD и автоматизации тестирования

## Контекст
Для ускорения выпуска новых версий и повышения качества необходимо автоматизировать процессы тестирования и доставки кода.

## Варианты решения

### 1. GitHub Actions
- **Плюсы:**  
  - Нативная интеграция с GitHub  
  - Бесплатный тариф для публичных репозиториев  
  - Поддержка кэширования сборок
- **Минусы:**  
  - Ограниченная кастомизация для сложных пайплайнов  
  - Зависимость от облачной инфраструктуры GitHub  

### 2. GitLab CI
- **Плюсы:**  
  - Полная интеграция с GitLab (issues, container registry)  
  - Встроенные security scanning и SAST  
  - Поддержка Kubernetes rollouts  
- **Минусы:**  
  - Сложность миграции для команд, использующих GitHub  
  - Ограничения в бесплатной версии (400 минут/мес)  

### 3. CircleCI
- **Плюсы:**  
  - Лидер в параллельных сборках (4x ускорение)  
  - Орбиты для быстрой интеграции с AWS/GCP  
  - Локальные runner для приватных сетей  
- **Минусы:**  
  - Высокая стоимость для enterprise (от $2.5k/мес)  
  - Сложность отладки распределенных задач  

### 4. Jenkins
- **Плюсы:**  
  - Полная кастомизация через 1800+ плагинов  
  - Бесплатное self-hosted решение  
  - Поддержка legacy-систем  
- **Минусы:**  
  - Высокие затраты на поддержку и обновления  
  - Отсутствие встроенной безопасности (требуются плагины)  

### 5. Azure DevOps
- **Плюсы:**  
  - Интеграция с Azure Cloud и MS Teams  
  - Встроенные инструменты для управления задачами  
  - Поддержка гибридных сред (cloud + on-premise)  
- **Минусы:**  
  - Слабая экосистема вне Azure  
  - Ограниченная документация на русском языке  

## Принятое решение
Использовать Gitlab CI для CI/CD.

## Обоснование
- Интегрированность: GitLab CI встроен в GitLab, объединяя управление кодом, пайплайнами и задачами в одном интерфейсе, что упрощает настройку и сопровождение.

- Гибкость и масштабируемость: поддерживает сложные сценарии с параллельными сборками, динамическими окружениями и интеграцией с Kubernetes.

- Автоматизация тестирования: позволяет запускать отдельные стадии для API и UI тестов, параллелить выполнение и генерировать отчёты (например, Allure), что ускоряет обратную связь и повышает качество.

## Последствия
- Для сложных сценариев пайплайнов приходится использовать bash-скрипты, что может усложнять поддержку и снижать удобство по сравнению с более программируемыми решениями, например Jenkins с Groovy.

- При высокой нагрузке GitLab Runner может потреблять значительные ресурсы, что увеличивает затраты на инфраструктуру и требует дополнительной настройки и мониторинга